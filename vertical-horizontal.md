数据库水平扩展与垂直扩展

 在互联网应用中。数据库经常是我们存储和訪问数据的经常使用介质。随着负载的增大，对数据库读写性能的要求往往成为非常大的挑战。在这种情况下我们能够考虑数据库相关的replication机制提高读写的性能。因为一般採用一写多读的replication机制（写master同步到多个slaves），导致这种机制往往会有缺陷。首先它依赖于读写的比例，假设写的操作过多，导致master往往成为性能的瓶颈所在，从而使得slaves的数据同步延迟也变大，进而大大消耗CPU的资源，而且导致数据的不一致从而影响到用户的体验。

  这个时候我们就要考虑使用数据库的sharding（分片）机制，这里面我们所说sharding机制并非一个数据库软件的附属功能，而是一种相对简朴的软件理念。

一般我们把sharding机制分成水平扩展（横向扩展，或者向外扩展）和垂直扩展两种方式。

详细什么是数据库的水平扩展和垂直扩展呢？我们以以下的样例来说明。

比方我们如今有两个表：用户信息表 产品订单表

水平的拆分的方案，即不改动数据库表结构。通过对表中数据的拆分而达到分片的目的：

1）使用用户id做hash，分解数据库，在訪问数据库的使用用户id做路由。

2）将产品订单表依照已下单和未下单区分成两个表。

一般水平拆分在查询数据库的时候可能会用到union操作。

 

垂直拆分的方案：将表和表分离，或者改动表结构，依照訪问的差异将某些列拆分出去。

1）将用户信息表放到一个数据库server，将产品订单表放到一个数据库server。

2）将用户信息表中主码（通常是user id）和一些经常使用的信息放到一个表，将主码和不经常使用的信息放到另外的表。这导致一般查询数据的时候可能会用到join操作。

在数据库的设计中，我们更关注数据库的水平扩展的能力。